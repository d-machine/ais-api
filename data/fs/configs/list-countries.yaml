actionType: EXECUTE_QUERY
queryInfo:
  returnType: MULTIPLE_ROWS
  query: |
    SELECT
      cm.id as country_id,
      cm.name as country_name,
      cm.code as country_code,
      cm.descr as description,
      cm.lua as last_updated_at,
      TRIM(CONCAT(u.first_name, ' ', u.last_name)) as last_updated_by_name
    FROM
      wms.country_master cm
      LEFT JOIN administration.user u ON cm.lub = u.id
    WHERE
      cm.is_active = true
    ORDER BY
      cm.name
  options:
    applyAccessLevelRestrictions: false
    applyFiltering: true
    applySorting: true
    applyPagenation: true
    onSuccess: refresh
    onFailure: showErrorPage
applicableActions:
  - add
  - edit
  - delete
actionConfig:
  add:
    label: Add Country
    actionType: DISPLAY_FORM
    formConfig: add-country
    onSuccess: refresh
    accessTypeRequired: 7-ADD
  edit:
    label: Edit Country
    actionType: DISPLAY_FORM
    formConfig: add-country
    accessTypeRequired: 7-EDIT
    payload:
      - country_id
    onSuccess: refresh
  delete:
    label: Delete Country
    actionType: EXECUTE_QUERY
    accessTypeRequired: 7-DELETE
    queryInfo:
      returnType: SINGLE_ROW
      query: SELECT wms.delete_country_master($1, $2) as id;
      payload:
        - country_id
      contextParams:
        - current_user_id
      path:
        - actionConfig
        - DELETE
    onSuccess: refresh
    onFailure: showErrorSnackbar

columns:
  - name: country_id
    label: ID
    visible: false
  - name: country_name
    label: Country Name
    visible: true
  - name: country_code
    label: Country Code
    visible: true
  - name: description
    label: Description
    visible: true
  - name: last_updated_at
    label: Last Updated At
    visible: true
  - name: last_updated_by_name
    label: Last Updated By
    visible: true 